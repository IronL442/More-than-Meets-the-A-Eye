experiment: "deepgaze_iie_finetune_kaggle"
output_dir: "/kaggle/working/outputs/finetune/deepgaze_iie"
seed: 1337

data:
  # Replace <your-dataset> with the Kaggle Dataset slug that contains img_bin/
  root: "/kaggle/input/training-data/img_bin"
  cv_folds: 5          # >= 2 enables CV
  cv_fold_index: null  # set to 0..4 to run a single fold
  cv_shuffle: true     # optional, defaults to data.shuffle
  shuffle: true
  sigma_px: 15
  batch_size: 1
  num_workers: 2
  gt_aggregate: "mean"
  gt_resize_interp: "bilinear"
  # Writable cache dir for mean GT maps (precompute optional but recommended)
  gt_cache_dir: "/kaggle/input/training-data/img_bin/gt_maps_mean"
  exclude_list: "/kaggle/working/splits/test.txt"
  allow_uniform_gt: false

model:
  centerbias_path: "data/centerbias/centerbias_mit1003.npy"
  use_uniform_centerbias: true
  device: "cuda"

training:
  progress: true
  loss: "kl"
  stages:
    - name: "feature_extraction"
      epochs: 15
      lr: 0.0001
      weight_decay: 0.0
      freeze:
        mode: "train_blocks"
        blocks: ["saliency", "finalizer"]
      train_features: false

    - name: "fine_tune"
      epochs: 10
      lr: 0.00001
      weight_decay: 0.0
      freeze:
        mode: "train_blocks"
        blocks: ["head"]
        backbone_last_n_modules: 0
      train_features: false

wandb:
  enabled: false
  project: null
  entity: null
  name: null
  group: null
  tags: []
  notes: null
  dir: null
  mode: null
